import{c as j,n as F,m as X,M as J,t as K,R as O,d as W,q as Z,b as P,aQ as $,v as ee,a as f,I as x,_ as G,p as te,f as ae,w as oe}from"./index-12ba5279.js";import{u as le,b as se}from"./index-d9b78adb.js";const[ne,h]=j("rate");function ie(t,n,s,r){return t>=n?{status:"full",value:1}:t+.5>=n&&s&&!r?{status:"half",value:.5}:t+1>=n&&s&&r?{status:"half",value:Math.round((t-n+1)*1e10)/1e10}:{status:"void",value:0}}const re={size:F,icon:X("star"),color:String,count:J(5),gutter:F,clearable:Boolean,readonly:Boolean,disabled:Boolean,voidIcon:X("star-o"),allowHalf:Boolean,voidColor:String,touchable:K,iconPrefix:String,modelValue:O(0),disabledColor:String};var ue=W({name:ne,props:re,emits:["change","update:modelValue"],setup(t,{emit:n}){const s=le(),[r,S]=se(),m=Z(),T=P(()=>t.readonly||t.disabled),I=P(()=>T.value||!t.touchable),Y=P(()=>Array(+t.count).fill("").map((a,e)=>ie(t.modelValue,e+1,t.allowHalf,t.readonly)));let l,u,g=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER;const V=()=>{u=G(m);const a=r.value.map(G);l=[],a.forEach((e,o)=>{g=Math.min(e.top,g),v=Math.max(e.top,v),t.allowHalf?l.push({score:o+.5,left:e.left,top:e.top,height:e.height},{score:o+1,left:e.left+e.width/2,top:e.top,height:e.height}):l.push({score:o+1,left:e.left,top:e.top,height:e.height})})},N=(a,e)=>{for(let o=l.length-1;o>0;o--)if(e>=u.top&&e<=u.bottom){if(a>l[o].left&&e>=l[o].top&&e<=l[o].top+l[o].height)return l[o].score}else{const c=e<u.top?g:v;if(a>l[o].left&&l[o].top===c)return l[o].score}return t.allowHalf?.5:1},w=a=>{T.value||a===t.modelValue||(n("update:modelValue",a),n("change",a))},q=a=>{I.value||(s.start(a),V())},D=a=>{if(!I.value&&(s.move(a),s.isHorizontal()&&!s.isTap.value)){const{clientX:e,clientY:o}=a.touches[0];te(a),w(N(e,o))}},L=(a,e)=>{const{icon:o,size:c,color:y,count:C,gutter:E,voidIcon:k,disabled:i,voidColor:M,allowHalf:_,iconPrefix:z,disabledColor:H}=t,b=e+1,R=a.status==="full",d=a.status==="void",Q=_&&a.value>0&&a.value<1;let B;E&&b!==+C&&(B={paddingRight:ae(E)});const U=A=>{V();let p=_?N(A.clientX,A.clientY):b;t.clearable&&s.isTap.value&&p===t.modelValue&&(p=0),w(p)};return f("div",{key:e,ref:S(e),role:"radio",style:B,class:h("item"),tabindex:i?void 0:0,"aria-setsize":C,"aria-posinset":b,"aria-checked":!d,onClick:U},[f(x,{size:c,name:R?o:k,class:h("icon",{disabled:i,full:R}),color:i?H:R?y:M,classPrefix:z},null),Q&&f(x,{size:c,style:{width:a.value+"em"},name:d?k:o,class:h("icon",["half",{disabled:i,full:!d}]),color:i?H:d?M:y,classPrefix:z},null)])};return $(()=>t.modelValue),ee("touchmove",D,{target:m}),()=>f("div",{ref:m,role:"radiogroup",class:h({readonly:t.readonly,disabled:t.disabled}),tabindex:t.disabled?void 0:0,"aria-disabled":t.disabled,"aria-readonly":t.readonly,onTouchstartPassive:q},[Y.value.map(L)])}});const fe=oe(ue);export{fe as R};
